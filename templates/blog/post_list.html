{% extends "blog/post_main.html" %}
{% block sub_title %}All posts{% endblock %}

{% block content %}
  <h1 class="h1">
    Posts
    {% if request.user.is_authenticated %}
      <a href="{% url 'post.create' %}" class="btn btn-outline-success btn-sm float-right mt-2">
        <i class="fas fa-plus"></i> Write new post
      </a>
    {% endif %}
  </h1>

  {% for post in post_list %}
    <article class="mb-3 shadow-sm px-2 py-2 clearfix">
      <h5 class="mt-0 mb-1">
        <a href="{{ post.get_absolute_url }}">
          {{ post.title }}
        </a>
      </h5>

      <p>
        {{ post.short_body }}
      </p>

      <div class="mb-2">
        {% if request.user.id is post.author.id %}
        <a href="{% url 'post.edit' post.id %}" class="btn btn-sm text-warning" title="Edit">
          <i class="fa fa-edit"></i>
        </a>
        {% endif %}

        <small>Was published
          <strong class="text-muted">{{ post.pub_date }}</strong>
          by
          <strong class="text-primary">
            <a href="{% url 'posts.filter' %}?author={{ post.author.id }}">{{ post.author }}</a>
          </strong>
        </small>

        <div class="btn-group float-right">
          <a href="{% url 'post.detail' post.id %}" class="btn btn-sm btn-outline-secondary">Read more</a>
          <a href="{% url 'post.detail.preview' post.id %}" class="btn btn-sm btn-outline-secondary" data-target="post-preview">Preview</a>
        </div>
      </div>
    </article>
  {% endfor %}


  {% if is_paginated %}
    <nav>
      <ul class="pagination">
        {% if page_obj.has_previous %}
          <li class="page-item">
            <a class="page-link" href="?page={{ page_obj.previous_page_number }}">Previous</a>
          </li>
          <li class="page-item">
            <a class="page-link" href="?page={{ page_obj.previous_page_number }}">
              {{ page_obj.previous_page_number }}
            </a>
          </li>
        {% endif %}

        <li class="page-item active">
          <a class="page-link" href="?page={{ page_obj.number }}">
            {{ page_obj.number }} <span class="sr-only">(current)</span>
          </a>
        </li>

        {% if page_obj.has_next %}
          <li class="page-item">
            <a class="page-link" href="?page={{ page_obj.next_page_number }}">
              {{ page_obj.next_page_number }}
            </a>
          </li>
          <li class="page-item">
            <a class="page-link" href="?page={{ page_obj.next_page_number }}">Next</a>
          </li>
        {% endif %}
      </ul>
    </nav>
  {% endif %}
{% endblock %}


{% block extra_body %}
  <div class="post-preview-container">
    <div id="postPreview" class="post-preview-content scrollbar-style"></div>
  </div>
{% endblock %}